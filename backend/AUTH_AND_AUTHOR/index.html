<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>
      Auth &amp; Author System ¬∑ SE-knowledges
    </title>
    <link rel="icon" type="image/svg+xml" href="/SE-knowledges/assets/favicon.svg">
    <link rel="stylesheet" href="/SE-knowledges/assets/css/style.css" />
    
  </head>
  <body>
    <header class="site">
  <div class="wrap nav">
    <div class="brand">
      <a class="title" href="/SE-knowledges/">SE-knowledges</a>
      <span class="subtitle">Technical notes and articles in Vietnamese and English.</span>
    </div>
    <div>
      
      
      
      

      

      
        <a class="button" href="/SE-knowledges/en/">English</a>
        <a class="button" href="/SE-knowledges/vi/">Ti·∫øng Vi·ªát</a>
      
      
      <!-- Auth Button (Hidden by default, JS toggles) -->
      <a class="button" id="auth-btn" href="/SE-knowledges/login/" style="margin-left: 10px; border: 1px solid #ddd;">Login</a>
      <!-- New Post Button (Only visible when logged in) -->
      <a class="button" id="new-post-btn" href="/SE-knowledges/admin/" style="margin-left: 10px; border: 1px solid #7ee787; background: rgba(126, 231, 135, 0.1); display: none;">+ New Post</a>
    </div>
  </div>
  
  <script>
    document.addEventListener("DOMContentLoaded", () => {
      const token = localStorage.getItem("token");
      const authBtn = document.getElementById("auth-btn");
      const newPostBtn = document.getElementById("new-post-btn");
      
      if (token) {
        // User is logged in
        authBtn.textContent = "Admin";
        authBtn.href = "/SE-knowledges/admin/";
        newPostBtn.style.display = "inline-block";
      } else {
        // User is not logged in
        newPostBtn.style.display = "none";
      }
    });
  </script>
</header>

    <main class="wrap">
      <h1 id="auth--author-system">Auth &amp; Author System</h1>

<h2 id="-authentication-system">üîê Authentication System</h2>

<h3 id="c√≥-ƒëƒÉng-k√Ω-v√†-ƒëƒÉng-nh·∫≠p">C√≥ ƒêƒÉng K√Ω v√† ƒêƒÉng Nh·∫≠p</h3>

<p><strong>‚úÖ C√≥ s·∫µn:</strong></p>

<ol>
  <li><strong>POST <code class="language-plaintext highlighter-rouge">/api/register</code></strong> - ƒêƒÉng k√Ω user m·ªõi
    <ul>
      <li>T·∫°o user v·ªõi username, email, password</li>
      <li>Role m·∫∑c ƒë·ªãnh: <code class="language-plaintext highlighter-rouge">'author'</code></li>
      <li>Password ƒë∆∞·ª£c hash (hi·ªán t·∫°i: base64 - <strong>KH√îNG AN TO√ÄN</strong>)</li>
    </ul>
  </li>
  <li><strong>POST <code class="language-plaintext highlighter-rouge">/api/login</code></strong> - ƒêƒÉng nh·∫≠p
    <ul>
      <li>Nh·∫≠n username v√† password</li>
      <li>Tr·∫£ v·ªÅ token v√† user info</li>
      <li>Token hi·ªán t·∫°i: base64 encoded (mock token - <strong>KH√îNG AN TO√ÄN</strong>)</li>
    </ul>
  </li>
</ol>

<h3 id="Ô∏è-v·∫•n-ƒë·ªÅ-hi·ªán-t·∫°i">‚ö†Ô∏è V·∫•n ƒê·ªÅ Hi·ªán T·∫°i</h3>

<ol>
  <li><strong>Mock Authentication:</strong>
    <ul>
      <li>Admin API ch·ªâ check c√≥ <code class="language-plaintext highlighter-rouge">Authorization</code> header hay kh√¥ng</li>
      <li>Kh√¥ng verify token th·ª±c s·ª±</li>
      <li>Code: <code class="language-plaintext highlighter-rouge">if (!authHeader) return error("Unauthorized", 401);</code></li>
    </ul>
  </li>
  <li><strong>Password Security:</strong>
    <ul>
      <li>Ch·ªâ d√πng <code class="language-plaintext highlighter-rouge">btoa(password)</code> - base64 encoding</li>
      <li><strong>KH√îNG PH·∫¢I</strong> hashing, d·ªÖ b·ªã decode</li>
      <li>C·∫ßn implement proper hashing (bcrypt/argon2)</li>
    </ul>
  </li>
  <li><strong>Token Security:</strong>
    <ul>
      <li>Token format: <code class="language-plaintext highlighter-rouge">btoa(</code>${user.id}:${user.username}:${Date.now()}<code class="language-plaintext highlighter-rouge">)</code></li>
      <li>Kh√¥ng c√≥ signature, kh√¥ng c√≥ expiration</li>
      <li>C·∫ßn implement JWT v·ªõi secret key</li>
    </ul>
  </li>
</ol>

<h3 id="-users-table-schema">üìã Users Table Schema</h3>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">CREATE</span> <span class="k">TABLE</span> <span class="n">users</span> <span class="p">(</span>
  <span class="n">id</span> <span class="nb">INTEGER</span> <span class="k">PRIMARY</span> <span class="k">KEY</span> <span class="n">AUTOINCREMENT</span><span class="p">,</span>
  <span class="n">username</span> <span class="nb">TEXT</span> <span class="k">UNIQUE</span> <span class="k">NOT</span> <span class="k">NULL</span><span class="p">,</span>
  <span class="n">email</span> <span class="nb">TEXT</span> <span class="k">UNIQUE</span> <span class="k">NOT</span> <span class="k">NULL</span><span class="p">,</span>
  <span class="n">password_hash</span> <span class="nb">TEXT</span> <span class="k">NOT</span> <span class="k">NULL</span><span class="p">,</span>
  <span class="k">role</span> <span class="nb">TEXT</span> <span class="k">DEFAULT</span> <span class="s1">'author'</span><span class="p">,</span>  <span class="c1">-- 'author', 'admin', etc.</span>
  <span class="n">created_at</span> <span class="nb">INTEGER</span>
<span class="p">);</span>
</code></pre></div></div>

<h3 id="-c√°ch-s·ª≠-d·ª•ng-hi·ªán-t·∫°i">üîß C√°ch S·ª≠ D·ª•ng Hi·ªán T·∫°i</h3>

<p><strong>ƒêƒÉng k√Ω:</strong></p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>POST /api/register
Content-Type: application/json

<span class="o">{</span>
  <span class="s2">"username"</span>: <span class="s2">"john_doe"</span>,
  <span class="s2">"password"</span>: <span class="s2">"password123"</span>,
  <span class="s2">"email"</span>: <span class="s2">"john@example.com"</span>
<span class="o">}</span>
</code></pre></div></div>

<p><strong>ƒêƒÉng nh·∫≠p:</strong></p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>POST /api/login
Content-Type: application/json

<span class="o">{</span>
  <span class="s2">"username"</span>: <span class="s2">"john_doe"</span>,
  <span class="s2">"password"</span>: <span class="s2">"password123"</span>
<span class="o">}</span>

<span class="c"># Response:</span>
<span class="o">{</span>
  <span class="s2">"success"</span>: <span class="nb">true</span>,
  <span class="s2">"token"</span>: <span class="s2">"base64encodedtoken"</span>,
  <span class="s2">"user"</span>: <span class="o">{</span>
    <span class="s2">"id"</span>: 1,
    <span class="s2">"username"</span>: <span class="s2">"john_doe"</span>,
    <span class="s2">"role"</span>: <span class="s2">"author"</span>
  <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<p><strong>S·ª≠ d·ª•ng token (Admin API):</strong></p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>POST /api/admin/articles
Authorization: Bearer base64encodedtoken
Content-Type: application/json

<span class="o">{</span>
  <span class="s2">"author_id"</span>: 1,
  <span class="s2">"topic_id"</span>: 1,
  <span class="s2">"translations"</span>: <span class="o">[</span>...]
<span class="o">}</span>
</code></pre></div></div>

<hr />

<h2 id="-author-system">üë§ Author System</h2>

<h3 id="-b√†i-post-c√≥-author">‚úÖ B√†i Post C√≥ Author</h3>

<p><strong>Database Schema:</strong></p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">articles</code> table c√≥ <code class="language-plaintext highlighter-rouge">author_id</code> field</li>
  <li>Foreign key ƒë·∫øn <code class="language-plaintext highlighter-rouge">users(id)</code></li>
  <li>M·ªói b√†i vi·∫øt ph·∫£i c√≥ m·ªôt author</li>
</ul>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">CREATE</span> <span class="k">TABLE</span> <span class="n">articles</span> <span class="p">(</span>
  <span class="n">id</span> <span class="nb">INTEGER</span> <span class="k">PRIMARY</span> <span class="k">KEY</span> <span class="n">AUTOINCREMENT</span><span class="p">,</span>
  <span class="n">topic_id</span> <span class="nb">INTEGER</span><span class="p">,</span>
  <span class="n">author_id</span> <span class="nb">INTEGER</span><span class="p">,</span>  <span class="c1">-- ‚Üê Link ƒë·∫øn users table</span>
  <span class="n">thumbnail_url</span> <span class="nb">TEXT</span><span class="p">,</span>
  <span class="n">is_published</span> <span class="nb">BOOLEAN</span> <span class="k">DEFAULT</span> <span class="mi">0</span><span class="p">,</span>
  <span class="n">created_at</span> <span class="nb">INTEGER</span><span class="p">,</span>
  <span class="n">updated_at</span> <span class="nb">INTEGER</span><span class="p">,</span>
  <span class="k">FOREIGN</span> <span class="k">KEY</span> <span class="p">(</span><span class="n">author_id</span><span class="p">)</span> <span class="k">REFERENCES</span> <span class="n">users</span><span class="p">(</span><span class="n">id</span><span class="p">)</span>
<span class="p">);</span>
</code></pre></div></div>

<h3 id="-author-information-trong-api">üìä Author Information trong API</h3>

<p><strong>1. Khi l·∫•y chi ti·∫øt b√†i vi·∫øt (<code class="language-plaintext highlighter-rouge">GET /api/articles/:slug</code>):</strong></p>
<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
  </span><span class="nl">"author_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
  </span><span class="nl">"author_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"john_doe"</span><span class="p">,</span><span class="w">  </span><span class="err">//</span><span class="w"> </span><span class="err">‚Üê</span><span class="w"> </span><span class="err">T·ª´</span><span class="w"> </span><span class="err">users</span><span class="w"> </span><span class="err">table</span><span class="w">
  </span><span class="nl">"title"</span><span class="p">:</span><span class="w"> </span><span class="s2">"..."</span><span class="p">,</span><span class="w">
  </span><span class="err">...</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<p><strong>2. Khi t·∫°o/c·∫≠p nh·∫≠t b√†i vi·∫øt (<code class="language-plaintext highlighter-rouge">POST /api/admin/articles</code>):</strong></p>
<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"author_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">  </span><span class="err">//</span><span class="w"> </span><span class="err">‚Üê</span><span class="w"> </span><span class="err">Ph·∫£i</span><span class="w"> </span><span class="err">truy·ªÅn</span><span class="w"> </span><span class="err">author_id</span><span class="w">
  </span><span class="nl">"topic_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
  </span><span class="nl">"translations"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="err">...</span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<p><strong>3. Khi l·∫•y danh s√°ch b√†i vi·∫øt (<code class="language-plaintext highlighter-rouge">GET /api/articles</code>):</strong></p>
<ul>
  <li>Hi·ªán t·∫°i <strong>KH√îNG</strong> c√≥ author info trong response</li>
  <li>C√≥ th·ªÉ th√™m n·∫øu c·∫ßn</li>
</ul>

<h3 id="-code-implementation">üîç Code Implementation</h3>

<p><strong>Get article detail v·ªõi author:</strong></p>
<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="nx">article</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">env</span><span class="p">.</span><span class="nx">DB</span><span class="p">.</span><span class="nx">prepare</span><span class="p">(</span><span class="s2">`
    SELECT a.*, top.name as topic_name, u.username as author_name
    FROM articles a
    LEFT JOIN topics top ON a.topic_id = top.id
    LEFT JOIN users u ON a.author_id = u.id  // ‚Üê Join v·ªõi users
    WHERE a.id = ?
`</span><span class="p">).</span><span class="nx">bind</span><span class="p">(</span><span class="nx">translation</span><span class="p">.</span><span class="nx">article_id</span><span class="p">).</span><span class="nx">first</span><span class="p">();</span>
</code></pre></div></div>

<p><strong>Create article v·ªõi author:</strong></p>
<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">await</span> <span class="nx">env</span><span class="p">.</span><span class="nx">DB</span><span class="p">.</span><span class="nx">prepare</span><span class="p">(</span>
    <span class="s2">`INSERT INTO articles (topic_id, author_id, thumbnail_url, is_published, created_at, updated_at)
     VALUES (?, ?, ?, ?, ?, ?)`</span>
<span class="p">).</span><span class="nx">bind</span><span class="p">(</span><span class="nx">topic_id</span><span class="p">,</span> <span class="nx">author_id</span><span class="p">,</span> <span class="nx">thumbnail_url</span><span class="p">,</span> <span class="nx">is_published</span> <span class="p">?</span> <span class="mi">1</span> <span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">now</span><span class="p">,</span> <span class="nx">now</span><span class="p">).</span><span class="nx">run</span><span class="p">();</span>
</code></pre></div></div>

<hr />

<h2 id="-workflow-hi·ªán-t·∫°i">üéØ Workflow Hi·ªán T·∫°i</h2>

<h3 id="1-user-ƒëƒÉng-k√Ω">1. User ƒëƒÉng k√Ω</h3>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>POST /api/register
‚Üí T·∫°o user trong database
‚Üí Role: 'author'
‚Üí Return user ID
</code></pre></div></div>

<h3 id="2-user-ƒëƒÉng-nh·∫≠p">2. User ƒëƒÉng nh·∫≠p</h3>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>POST /api/login
‚Üí Verify username/password
‚Üí Generate token (mock)
‚Üí Return token + user info
</code></pre></div></div>

<h3 id="3-t·∫°o-b√†i-vi·∫øt">3. T·∫°o b√†i vi·∫øt</h3>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>POST /api/admin/articles
Headers: Authorization: Bearer token
Body: {
  author_id: 1,  // ‚Üê ID c·ªßa user ƒë√£ ƒëƒÉng nh·∫≠p
  topic_id: 1,
  translations: [...]
}
‚Üí T·∫°o article v·ªõi author_id
</code></pre></div></div>

<h3 id="4-xem-b√†i-vi·∫øt">4. Xem b√†i vi·∫øt</h3>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>GET /api/articles/my-slug
‚Üí Return article v·ªõi author_name
</code></pre></div></div>

<hr />

<h2 id="Ô∏è-v·∫•n-ƒë·ªÅ-v√†-c·∫£i-thi·ªán-c·∫ßn-thi·∫øt">‚ö†Ô∏è V·∫•n ƒê·ªÅ v√† C·∫£i Thi·ªán C·∫ßn Thi·∫øt</h2>

<h3 id="-critical-issues">üî¥ Critical Issues</h3>

<ol>
  <li><strong>Authentication kh√¥ng th·ª±c s·ª± ho·∫°t ƒë·ªông:</strong>
    <ul>
      <li>Ch·ªâ check c√≥ header hay kh√¥ng</li>
      <li>Kh√¥ng verify token</li>
      <li>Kh√¥ng check user permissions</li>
    </ul>
  </li>
  <li><strong>Password kh√¥ng an to√†n:</strong>
    <ul>
      <li>Base64 encoding ‚â† hashing</li>
      <li>D·ªÖ b·ªã decode</li>
    </ul>
  </li>
  <li><strong>Token kh√¥ng an to√†n:</strong>
    <ul>
      <li>Kh√¥ng c√≥ signature</li>
      <li>Kh√¥ng c√≥ expiration</li>
      <li>C√≥ th·ªÉ fake d·ªÖ d√†ng</li>
    </ul>
  </li>
</ol>

<h3 id="-improvements-needed">üü° Improvements Needed</h3>

<ol>
  <li><strong>Implement JWT Authentication:</strong>
    <div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// Generate JWT token</span>
<span class="kd">const</span> <span class="nx">token</span> <span class="o">=</span> <span class="nx">jwt</span><span class="p">.</span><span class="nx">sign</span><span class="p">(</span>
  <span class="p">{</span> <span class="na">id</span><span class="p">:</span> <span class="nx">user</span><span class="p">.</span><span class="nx">id</span><span class="p">,</span> <span class="na">username</span><span class="p">:</span> <span class="nx">user</span><span class="p">.</span><span class="nx">username</span><span class="p">,</span> <span class="na">role</span><span class="p">:</span> <span class="nx">user</span><span class="p">.</span><span class="nx">role</span> <span class="p">},</span>
  <span class="nx">env</span><span class="p">.</span><span class="nx">JWT_SECRET</span><span class="p">,</span>
  <span class="p">{</span> <span class="na">expiresIn</span><span class="p">:</span> <span class="dl">'</span><span class="s1">7d</span><span class="dl">'</span> <span class="p">}</span>
<span class="p">);</span>
   
<span class="c1">// Verify token</span>
<span class="kd">const</span> <span class="nx">decoded</span> <span class="o">=</span> <span class="nx">jwt</span><span class="p">.</span><span class="nx">verify</span><span class="p">(</span><span class="nx">token</span><span class="p">,</span> <span class="nx">env</span><span class="p">.</span><span class="nx">JWT_SECRET</span><span class="p">);</span>
</code></pre></div>    </div>
  </li>
  <li><strong>Implement Password Hashing:</strong>
    <div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// Hash password (c·∫ßn d√πng SubtleCrypto trong Workers)</span>
<span class="kd">const</span> <span class="nx">encoder</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">TextEncoder</span><span class="p">();</span>
<span class="kd">const</span> <span class="nx">data</span> <span class="o">=</span> <span class="nx">encoder</span><span class="p">.</span><span class="nx">encode</span><span class="p">(</span><span class="nx">password</span><span class="p">);</span>
<span class="kd">const</span> <span class="nx">hashBuffer</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">crypto</span><span class="p">.</span><span class="nx">subtle</span><span class="p">.</span><span class="nx">digest</span><span class="p">(</span><span class="dl">'</span><span class="s1">SHA-256</span><span class="dl">'</span><span class="p">,</span> <span class="nx">data</span><span class="p">);</span>
<span class="c1">// Ho·∫∑c d√πng bcrypt/argon2 n·∫øu c√≥ th·ªÉ</span>
</code></pre></div>    </div>
  </li>
  <li><strong>Add Authorization Middleware:</strong>
    <div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">async</span> <span class="kd">function</span> <span class="nx">verifyAuth</span><span class="p">(</span><span class="nx">request</span><span class="p">,</span> <span class="nx">env</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="nx">authHeader</span> <span class="o">=</span> <span class="nx">request</span><span class="p">.</span><span class="nx">headers</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span><span class="dl">"</span><span class="s2">Authorization</span><span class="dl">"</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">authHeader</span><span class="p">)</span> <span class="k">return</span> <span class="kc">null</span><span class="p">;</span>
     
  <span class="kd">const</span> <span class="nx">token</span> <span class="o">=</span> <span class="nx">authHeader</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="dl">"</span><span class="s2">Bearer </span><span class="dl">"</span><span class="p">,</span> <span class="dl">""</span><span class="p">);</span>
  <span class="c1">// Verify JWT token</span>
  <span class="kd">const</span> <span class="nx">decoded</span> <span class="o">=</span> <span class="nx">jwt</span><span class="p">.</span><span class="nx">verify</span><span class="p">(</span><span class="nx">token</span><span class="p">,</span> <span class="nx">env</span><span class="p">.</span><span class="nx">JWT_SECRET</span><span class="p">);</span>
  <span class="k">return</span> <span class="nx">decoded</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>    </div>
  </li>
  <li><strong>Add Role-Based Access Control:</strong>
    <div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">function</span> <span class="nx">requireRole</span><span class="p">(</span><span class="nx">user</span><span class="p">,</span> <span class="nx">requiredRole</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">user</span><span class="p">.</span><span class="nx">role</span> <span class="o">!==</span> <span class="nx">requiredRole</span> <span class="o">&amp;&amp;</span> <span class="nx">user</span><span class="p">.</span><span class="nx">role</span> <span class="o">!==</span> <span class="dl">'</span><span class="s1">admin</span><span class="dl">'</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">throw</span> <span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="dl">"</span><span class="s2">Insufficient permissions</span><span class="dl">"</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>    </div>
  </li>
  <li><strong>Auto-set author_id t·ª´ token:</strong>
    <div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// Thay v√¨ ph·∫£i truy·ªÅn author_id trong body</span>
<span class="c1">// T·ª± ƒë·ªông l·∫•y t·ª´ token</span>
<span class="kd">const</span> <span class="nx">user</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">verifyAuth</span><span class="p">(</span><span class="nx">request</span><span class="p">,</span> <span class="nx">env</span><span class="p">);</span>
<span class="kd">const</span> <span class="nx">author_id</span> <span class="o">=</span> <span class="nx">user</span><span class="p">.</span><span class="nx">id</span><span class="p">;</span>
</code></pre></div>    </div>
  </li>
</ol>

<hr />

<h2 id="-recommendations">üìù Recommendations</h2>

<h3 id="cho-production">Cho Production:</h3>

<ol>
  <li><strong>Disable <code class="language-plaintext highlighter-rouge">/api/register</code></strong> ho·∫∑c th√™m:
    <ul>
      <li>CAPTCHA</li>
      <li>Email verification</li>
      <li>Rate limiting</li>
    </ul>
  </li>
  <li><strong>Implement proper authentication:</strong>
    <ul>
      <li>JWT v·ªõi secret key</li>
      <li>Token expiration</li>
      <li>Refresh tokens</li>
    </ul>
  </li>
  <li><strong>Implement password hashing:</strong>
    <ul>
      <li>SHA-256 ho·∫∑c bcrypt/argon2</li>
      <li>Salt + pepper</li>
    </ul>
  </li>
  <li><strong>Add authorization:</strong>
    <ul>
      <li>Verify token trong m·ªçi admin endpoint</li>
      <li>Check user permissions</li>
      <li>Auto-set author_id t·ª´ token</li>
    </ul>
  </li>
  <li><strong>Add user management:</strong>
    <ul>
      <li>GET <code class="language-plaintext highlighter-rouge">/api/users</code> (admin only)</li>
      <li>PUT <code class="language-plaintext highlighter-rouge">/api/users/:id</code> (update user)</li>
      <li>DELETE <code class="language-plaintext highlighter-rouge">/api/users/:id</code> (admin only)</li>
    </ul>
  </li>
</ol>

<hr />

<h2 id="-testing-auth-flow">üß™ Testing Auth Flow</h2>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># 1. Register</span>
curl <span class="nt">-X</span> POST https://your-worker.workers.dev/api/register <span class="se">\</span>
  <span class="nt">-H</span> <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
  <span class="nt">-d</span> <span class="s1">'{"username":"testuser","password":"test123","email":"test@example.com"}'</span>

<span class="c"># 2. Login</span>
curl <span class="nt">-X</span> POST https://your-worker.workers.dev/api/login <span class="se">\</span>
  <span class="nt">-H</span> <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
  <span class="nt">-d</span> <span class="s1">'{"username":"testuser","password":"test123"}'</span>

<span class="c"># 3. Create article (v·ªõi token)</span>
curl <span class="nt">-X</span> POST https://your-worker.workers.dev/api/admin/articles <span class="se">\</span>
  <span class="nt">-H</span> <span class="s2">"Authorization: Bearer YOUR_TOKEN"</span> <span class="se">\</span>
  <span class="nt">-H</span> <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
  <span class="nt">-d</span> <span class="s1">'{
    "author_id": 1,
    "topic_id": 1,
    "is_published": true,
    "translations": [...]
  }'</span>
</code></pre></div></div>

<hr />

<h2 id="-summary">üìö Summary</h2>

<p><strong>‚úÖ C√≥ s·∫µn:</strong></p>
<ul>
  <li>Register endpoint</li>
  <li>Login endpoint</li>
  <li>Users table v·ªõi roles</li>
  <li>Articles c√≥ author_id</li>
  <li>Author name trong article detail</li>
</ul>

<p><strong>‚ö†Ô∏è C·∫ßn c·∫£i thi·ªán:</strong></p>
<ul>
  <li>Authentication th·ª±c s·ª± (JWT)</li>
  <li>Password hashing</li>
  <li>Token verification</li>
  <li>Auto-set author_id t·ª´ token</li>
  <li>Role-based access control</li>
</ul>

<p><strong>üéØ Hi·ªán t·∫°i:</strong></p>
<ul>
  <li>Auth system l√† <strong>mock/prototype</strong></li>
  <li>C√≥ th·ªÉ d√πng ƒë·ªÉ test v√† develop</li>
  <li><strong>KH√îNG</strong> an to√†n cho production</li>
  <li>C·∫ßn implement proper security tr∆∞·ªõc khi deploy</li>
</ul>


    </main>
    <footer class="site">
  <div class="wrap">
    <div class="panel">
      <div>
        <span class="pill">EN/VI</span>
        <span class="pill">GitHub Pages</span>
        <span class="pill">Jekyll</span>
      </div>
      <div style="margin-top: 10px;">
        ¬© 2026 SE-knowledges. Built with Jekyll on GitHub Pages.
      </div>
    </div>
  </div>
</footer>


    
    <!-- Global API Configuration -->
    <script>
      window.API_URL = "https://se-knowledges.jayce-it-work.workers.dev";
      window.VIEW_API_URL = "https://se-knowledges.jayce-it-work.workers.dev";
      console.log("API URL configured:", window.API_URL);
    </script>
    
    <!-- Load utils.js for all pages -->
    <script src="/SE-knowledges/assets/js/utils.js"></script>
    
    <!-- Page-specific scripts -->
    
    
    
    
    
    
    
    
    <!-- Verify utils loaded -->
    <script>
      console.log("Utils loaded:", typeof parseApiResponse !== 'undefined');
    </script>
  </body>
</html>

