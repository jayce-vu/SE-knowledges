<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>
      Hướng dẫn Deploy Tính Năng Đếm Lượt View với Cloudflare D1 · SE-knowledges
    </title>
    <link rel="icon" type="image/svg+xml" href="/SE-knowledges/pr-preview/pr-11/assets/favicon.svg">
    <link rel="stylesheet" href="/SE-knowledges/pr-preview/pr-11/assets/css/style.css" />
  </head>
  <body>
    <header class="site">
  <div class="wrap nav">
    <div class="brand">
      <a class="title" href="/SE-knowledges/pr-preview/pr-11/">SE-knowledges</a>
      <span class="subtitle">Technical notes and articles in Vietnamese and English.</span>
    </div>
    <div>
      
      
      
      

      

      
        <a class="button" href="/SE-knowledges/pr-preview/pr-11/en/">English</a>
        <a class="button" href="/SE-knowledges/pr-preview/pr-11/vi/">Tiếng Việt</a>
      
    </div>
  </div>
</header>

    <main class="wrap">
      <h1 id="hướng-dẫn-deploy-tính-năng-đếm-lượt-view-với-cloudflare-d1">Hướng dẫn Deploy Tính Năng Đếm Lượt View với Cloudflare D1</h1>

<p>Tính năng này sử dụng <strong>Cloudflare Workers</strong> (miễn phí) để xử lý logic đếm và <strong>Cloudflare D1</strong> (SQL Database) để lưu trữ dữ liệu bền vững.</p>

<h2 id="bước-1-tạo-cloudflare-worker">Bước 1: Tạo Cloudflare Worker</h2>

<ol>
  <li>Đăng nhập vào <a href="https://dash.cloudflare.com/">Cloudflare Dashboard</a>.</li>
  <li>Vào mục <strong>Workers &amp; Pages</strong>.</li>
  <li>Nhấn <strong>Create Application</strong> -&gt; <strong>Create Worker</strong>.</li>
  <li>Đặt tên cho worker (ví dụ: <code class="language-plaintext highlighter-rouge">blog-views-d1</code>).</li>
  <li>Nhấn <strong>Deploy</strong> (đừng lo về code mặc định, ta sẽ sửa sau).</li>
</ol>

<h2 id="bước-2-tạo-d1-database">Bước 2: Tạo D1 Database</h2>

<ol>
  <li>Trong dashboard Workers &amp; Pages, chọn <strong>D1</strong> ở menu trái.</li>
  <li>Nhấn <strong>Create Database</strong>.</li>
  <li>Chọn <strong>Dashboard</strong> -&gt; Đặt tên <code class="language-plaintext highlighter-rouge">blog-views-db</code> -&gt; <strong>Create</strong>.</li>
  <li>Vào tab <strong>Console</strong> của database vừa tạo, copy nội dung file <code class="language-plaintext highlighter-rouge">backend/schema.sql</code> và dán vào, sau đó nhấn <strong>Execute</strong> để tạo bảng.</li>
</ol>

<h2 id="bước-3-liên-kết-d1-với-worker">Bước 3: Liên kết D1 với Worker</h2>

<ol>
  <li>Quay lại Worker <code class="language-plaintext highlighter-rouge">blog-views-d1</code> đã tạo ở Bước 1.</li>
  <li>Vào <strong>Settings</strong> -&gt; <strong>Variables</strong>.</li>
  <li>Tại mục <strong>D1 Database Bindings</strong>, nhấn <strong>Add binding</strong>:
    <ul>
      <li><strong>Variable name</strong>: <code class="language-plaintext highlighter-rouge">DB</code> (Bắt buộc phải là tên này).</li>
      <li><strong>D1 Database</strong>: Chọn <code class="language-plaintext highlighter-rouge">blog-views-db</code> vừa tạo.</li>
    </ul>
  </li>
  <li>Nhấn <strong>Save and Deploy</strong>.</li>
</ol>

<h2 id="bước-4-cập-nhật-code-worker">Bước 4: Cập nhật Code Worker</h2>

<ol>
  <li>Vào tab <strong>Overview</strong> của Worker, nhấn <strong>Quick Edit</strong>.</li>
  <li>Xóa hết code cũ, copy toàn bộ nội dung từ file <code class="language-plaintext highlighter-rouge">backend/worker.js</code> trong project này dán vào.</li>
  <li>Nhấn <strong>Save and Deploy</strong>.</li>
</ol>

<h2 id="bước-5-cấu-hình-blog">Bước 5: Cấu hình Blog</h2>

<ol>
  <li>Copy đường dẫn Worker của bạn (dạng <code class="language-plaintext highlighter-rouge">https://blog-views-d1.username.workers.dev</code>).</li>
  <li>Mở file <code class="language-plaintext highlighter-rouge">_config.yml</code> trong source code blog.</li>
  <li>Tìm dòng <code class="language-plaintext highlighter-rouge">view_api_url</code> và dán đường dẫn vào:</li>
</ol>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">view_api_url</span><span class="pi">:</span> <span class="s2">"</span><span class="s">https://blog-views-d1.username.workers.dev"</span>
</code></pre></div></div>

<ol>
  <li>Commit và Push code lên GitHub.</li>
</ol>

<h2 id="kiểm-tra">Kiểm tra</h2>

<p>Vào một bài viết bất kỳ trên blog, nếu thấy số lượt view hiển thị (ban đầu là 0 hoặc 1) là thành công!</p>

    </main>
    <footer class="site">
  <div class="wrap">
    <div class="panel">
      <div>
        <span class="pill">EN/VI</span>
        <span class="pill">GitHub Pages</span>
        <span class="pill">Jekyll</span>
      </div>
      <div style="margin-top: 10px;">
        © 2026 SE-knowledges. Built with Jekyll on GitHub Pages.
      </div>
    </div>
  </div>
</footer>


  </body>
</html>

