<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>
      Frontend Architecture Review Â· SE-knowledges
    </title>
    <link rel="icon" type="image/svg+xml" href="/SE-knowledges/pr-preview/pr-12/assets/favicon.svg">
    <link rel="stylesheet" href="/SE-knowledges/pr-preview/pr-12/assets/css/style.css" />
  </head>
  <body>
    <header class="site">
  <div class="wrap nav">
    <div class="brand">
      <a class="title" href="/SE-knowledges/pr-preview/pr-12/">SE-knowledges</a>
      <span class="subtitle">Technical notes and articles in Vietnamese and English.</span>
    </div>
    <div>
      
      
      
      

      

      
        <a class="button" href="/SE-knowledges/pr-preview/pr-12/en/">English</a>
        <a class="button" href="/SE-knowledges/pr-preview/pr-12/vi/">Tiáº¿ng Viá»‡t</a>
      
      
      <!-- Auth Button (Hidden by default, JS toggles) -->
      <a class="button" id="auth-btn" href="/SE-knowledges/pr-preview/pr-12/login.html" style="margin-left: 10px; border: 1px solid #ddd;">Login</a>
    </div>
  </div>
  
  <script>
    document.addEventListener("DOMContentLoaded", () => {
      const token = localStorage.getItem("token");
      const authBtn = document.getElementById("auth-btn");
      if (token) {
        authBtn.textContent = "Admin";
        authBtn.href = "/SE-knowledges/pr-preview/pr-12/admin.html";
      }
    });
  </script>
</header>

    <main class="wrap">
      <h1 id="frontend-architecture-review">Frontend Architecture Review</h1>

<p><strong>NgÃ y review:</strong> $(date)
<strong>Status:</strong> âš ï¸ Cáº§n cáº£i thiá»‡n má»™t sá»‘ Ä‘iá»ƒm</p>

<hr />

<h2 id="-tá»•ng-quan-kiáº¿n-trÃºc">ğŸ“Š Tá»•ng Quan Kiáº¿n TrÃºc</h2>

<h3 id="hiá»‡n-táº¡i">Hiá»‡n Táº¡i</h3>
<ul>
  <li><strong>Framework:</strong> Jekyll (Static Site Generator)</li>
  <li><strong>Hosting:</strong> GitHub Pages</li>
  <li><strong>Backend API:</strong> Cloudflare Workers (D1 Database)</li>
  <li><strong>Architecture:</strong> Hybrid (Static + Dynamic API calls)</li>
  <li><strong>Language:</strong> Vanilla JavaScript (no framework)</li>
</ul>

<h3 id="cáº¥u-trÃºc-thÆ°-má»¥c">Cáº¥u TrÃºc ThÆ° Má»¥c</h3>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>/
â”œâ”€â”€ _layouts/          # Jekyll layouts
â”‚   â”œâ”€â”€ default.html
â”‚   â”œâ”€â”€ post.html
â”‚   â””â”€â”€ home.html
â”œâ”€â”€ _includes/         # Reusable components
â”‚   â”œâ”€â”€ header.html
â”‚   â””â”€â”€ footer.html
â”œâ”€â”€ assets/
â”‚   â”œâ”€â”€ css/
â”‚   â”‚   â”œâ”€â”€ style.css
â”‚   â”‚   â””â”€â”€ admin.css
â”‚   â””â”€â”€ js/
â”‚       â”œâ”€â”€ view-count.js
â”‚       â””â”€â”€ admin.js
â”œâ”€â”€ admin.html         # Admin panel
â”œâ”€â”€ login.html         # Auth page
â”œâ”€â”€ view.html          # Article viewer
â””â”€â”€ index.html         # Home page
</code></pre></div></div>

<hr />

<h2 id="-Ä‘iá»ƒm-tá»‘t">âœ… Äiá»ƒm Tá»‘t</h2>

<h3 id="1-separation-of-concerns">1. <strong>Separation of Concerns</strong></h3>
<ul>
  <li>âœ… Layouts vÃ  includes Ä‘Æ°á»£c tÃ¡ch riÃªng</li>
  <li>âœ… CSS vÃ  JS Ä‘Æ°á»£c tá»• chá»©c trong <code class="language-plaintext highlighter-rouge">assets/</code></li>
  <li>âœ… Admin vÃ  public pages tÃ¡ch biá»‡t</li>
</ul>

<h3 id="2-jekyll-integration">2. <strong>Jekyll Integration</strong></h3>
<ul>
  <li>âœ… Sá»­ dá»¥ng Jekyll variables (<code class="language-plaintext highlighter-rouge">site.view_api_url</code>)</li>
  <li>âœ… Liquid templating cho static content</li>
  <li>âœ… Bilingual support vá»›i collections</li>
</ul>

<h3 id="3-api-integration">3. <strong>API Integration</strong></h3>
<ul>
  <li>âœ… Fetch API Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘Ãºng cÃ¡ch</li>
  <li>âœ… CORS Ä‘Æ°á»£c handle</li>
  <li>âœ… Error handling cÆ¡ báº£n</li>
</ul>

<h3 id="4-features">4. <strong>Features</strong></h3>
<ul>
  <li>âœ… View count integration</li>
  <li>âœ… Comments system</li>
  <li>âœ… Admin panel vá»›i CRUD</li>
  <li>âœ… Bilingual support</li>
</ul>

<hr />

<h2 id="ï¸-váº¥n-Ä‘á»-cáº§n-sá»­a">âš ï¸ Váº¥n Äá» Cáº§n Sá»­a</h2>

<h3 id="-critical-issues">ğŸ”´ Critical Issues</h3>

<h4 id="1-api-response-format-mismatch">1. <strong>API Response Format Mismatch</strong></h4>
<p><strong>File:</strong> <code class="language-plaintext highlighter-rouge">index.html</code>, <code class="language-plaintext highlighter-rouge">admin.js</code></p>

<p><strong>Váº¥n Ä‘á»:</strong></p>
<ul>
  <li>API tráº£ vá» <code class="language-plaintext highlighter-rouge">{ data: [...], pagination: {...} }</code></li>
  <li>Frontend expect <code class="language-plaintext highlighter-rouge">Array</code> trá»±c tiáº¿p</li>
</ul>

<p><strong>Code hiá»‡n táº¡i:</strong></p>
<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="nx">posts</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">postsRes</span><span class="p">.</span><span class="nx">json</span><span class="p">();</span>
<span class="nx">posts</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="nx">p</span> <span class="o">=&gt;</span> <span class="p">{</span> <span class="p">...</span> <span class="p">});</span> <span class="c1">// âŒ posts is object, not array</span>
</code></pre></div></div>

<p><strong>NÃªn sá»­a:</strong></p>
<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="nx">response</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">postsRes</span><span class="p">.</span><span class="nx">json</span><span class="p">();</span>
<span class="kd">const</span> <span class="nx">posts</span> <span class="o">=</span> <span class="nx">response</span><span class="p">.</span><span class="nx">data</span> <span class="o">||</span> <span class="nx">response</span><span class="p">;</span> <span class="c1">// Handle both formats</span>
<span class="kd">const</span> <span class="nx">pagination</span> <span class="o">=</span> <span class="nx">response</span><span class="p">.</span><span class="nx">pagination</span><span class="p">;</span>
</code></pre></div></div>

<p><strong>Impact:</strong> High - Home page vÃ  admin list sáº½ crash</p>

<hr />

<h4 id="2-xss-vulnerability-trong-comments">2. <strong>XSS Vulnerability trong Comments</strong></h4>
<p><strong>File:</strong> <code class="language-plaintext highlighter-rouge">view.html</code> (line 136)</p>

<p><strong>Váº¥n Ä‘á»:</strong></p>
<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">$</span><span class="p">{</span><span class="nx">c</span><span class="p">.</span><span class="nx">content</span><span class="p">}</span>  <span class="c1">// âŒ Direct HTML injection</span>
</code></pre></div></div>

<p><strong>NÃªn sá»­a:</strong></p>
<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">$</span><span class="p">{</span><span class="nx">escapeHtml</span><span class="p">(</span><span class="nx">c</span><span class="p">.</span><span class="nx">content</span><span class="p">)}</span>  <span class="c1">// Sanitize HTML</span>

<span class="kd">function</span> <span class="nx">escapeHtml</span><span class="p">(</span><span class="nx">text</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="nx">div</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="dl">'</span><span class="s1">div</span><span class="dl">'</span><span class="p">);</span>
  <span class="nx">div</span><span class="p">.</span><span class="nx">textContent</span> <span class="o">=</span> <span class="nx">text</span><span class="p">;</span>
  <span class="k">return</span> <span class="nx">div</span><span class="p">.</span><span class="nx">innerHTML</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<p><strong>Impact:</strong> High - Security risk</p>

<hr />

<h4 id="3-view-count-key-mismatch">3. <strong>View Count Key Mismatch</strong></h4>
<p><strong>File:</strong> <code class="language-plaintext highlighter-rouge">view-count.js</code>, <code class="language-plaintext highlighter-rouge">post.html</code></p>

<p><strong>Váº¥n Ä‘á»:</strong></p>
<ul>
  <li>Frontend dÃ¹ng <code class="language-plaintext highlighter-rouge">pair_id</code> tá»« meta tag</li>
  <li>API expect <code class="language-plaintext highlighter-rouge">slug</code> trong query parameter</li>
  <li>KhÃ´ng match vá»›i nhau</li>
</ul>

<p><strong>Code hiá»‡n táº¡i:</strong></p>
<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// view-count.js</span>
<span class="kd">const</span> <span class="nx">pairId</span> <span class="o">=</span> <span class="nx">metaPairId</span><span class="p">.</span><span class="nx">getAttribute</span><span class="p">(</span><span class="dl">'</span><span class="s1">content</span><span class="dl">'</span><span class="p">);</span>
<span class="nx">fetch</span><span class="p">(</span><span class="s2">`</span><span class="p">${</span><span class="nx">apiUrl</span><span class="p">}</span><span class="s2">/increment?key=</span><span class="p">${</span><span class="nx">pairId</span><span class="p">}</span><span class="s2">`</span><span class="p">);</span>  <span class="c1">// âŒ pair_id â‰  slug</span>
</code></pre></div></div>

<p><strong>NÃªn sá»­a:</strong></p>
<ul>
  <li>Option 1: DÃ¹ng slug thay vÃ¬ pair_id</li>
  <li>Option 2: API accept cáº£ pair_id vÃ  slug</li>
  <li>Option 3: Resolve pair_id â†’ slug trÆ°á»›c khi call API</li>
</ul>

<p><strong>Impact:</strong> High - View count khÃ´ng hoáº¡t Ä‘á»™ng</p>

<hr />

<h4 id="4-hardcoded-author-id">4. <strong>Hardcoded Author ID</strong></h4>
<p><strong>File:</strong> <code class="language-plaintext highlighter-rouge">admin.js</code> (line 180)</p>

<p><strong>Váº¥n Ä‘á»:</strong></p>
<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">author_id</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="c1">// Hardcoded for now</span>
</code></pre></div></div>

<p><strong>NÃªn sá»­a:</strong></p>
<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// Get from logged in user</span>
<span class="kd">const</span> <span class="nx">user</span> <span class="o">=</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="nx">localStorage</span><span class="p">.</span><span class="nx">getItem</span><span class="p">(</span><span class="dl">"</span><span class="s2">user</span><span class="dl">"</span><span class="p">));</span>
<span class="nl">author_id</span><span class="p">:</span> <span class="nx">user</span><span class="p">?.</span><span class="nx">id</span> <span class="o">||</span> <span class="kc">null</span><span class="p">,</span>
</code></pre></div></div>

<p><strong>Impact:</strong> Medium - Táº¥t cáº£ bÃ i viáº¿t cÃ³ cÃ¹ng author</p>

<hr />

<h3 id="-important-issues">ğŸŸ¡ Important Issues</h3>

<h4 id="5-inline-scripts">5. <strong>Inline Scripts</strong></h4>
<p><strong>Váº¥n Ä‘á»:</strong></p>
<ul>
  <li>Scripts Ä‘Æ°á»£c viáº¿t trá»±c tiáº¿p trong HTML files</li>
  <li>KhÃ³ maintain vÃ  test</li>
  <li>KhÃ´ng cÃ³ module bundling</li>
</ul>

<p><strong>Files:</strong></p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">index.html</code> - inline script</li>
  <li><code class="language-plaintext highlighter-rouge">view.html</code> - inline script</li>
  <li><code class="language-plaintext highlighter-rouge">login.html</code> - inline script</li>
</ul>

<p><strong>NÃªn tÃ¡ch ra:</strong></p>
<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// assets/js/home.js</span>
<span class="c1">// assets/js/article-viewer.js</span>
<span class="c1">// assets/js/auth.js</span>
</code></pre></div></div>

<hr />

<h4 id="6-api-url-configuration">6. <strong>API URL Configuration</strong></h4>
<p><strong>Váº¥n Ä‘á»:</strong></p>
<ul>
  <li>API URL Ä‘Æ°á»£c set á»Ÿ nhiá»u nÆ¡i</li>
  <li>Hardcoded trong má»™t sá»‘ files</li>
  <li>KhÃ´ng nháº¥t quÃ¡n</li>
</ul>

<p><strong>Files:</strong></p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">admin.js</code>: <code class="language-plaintext highlighter-rouge">const API_URL = window.API_URL || "https://post-views..."</code></li>
  <li><code class="language-plaintext highlighter-rouge">view-count.js</code>: <code class="language-plaintext highlighter-rouge">let apiUrl = window.VIEW_API_URL;</code></li>
  <li><code class="language-plaintext highlighter-rouge">index.html</code>: <code class="language-plaintext highlighter-rouge">const API_URL = "https://se-knowledges.jayce-it-work.workers.dev";</code></li>
</ul>

<p><strong>NÃªn:</strong></p>
<ul>
  <li>Táº¡o má»™t config file chung</li>
  <li>Hoáº·c dÃ¹ng Jekyll config nháº¥t quÃ¡n</li>
</ul>

<hr />

<h4 id="7-error-handling-khÃ´ng-nháº¥t-quÃ¡n">7. <strong>Error Handling KhÃ´ng Nháº¥t QuÃ¡n</strong></h4>
<p><strong>Váº¥n Ä‘á»:</strong></p>
<ul>
  <li>Má»™t sá»‘ nÆ¡i dÃ¹ng <code class="language-plaintext highlighter-rouge">alert()</code></li>
  <li>Má»™t sá»‘ nÆ¡i dÃ¹ng <code class="language-plaintext highlighter-rouge">console.error()</code></li>
  <li>KhÃ´ng cÃ³ user-friendly error messages</li>
</ul>

<p><strong>NÃªn:</strong></p>
<ul>
  <li>Táº¡o error handler chung</li>
  <li>Hiá»ƒn thá»‹ errors trong UI thay vÃ¬ alert</li>
</ul>

<hr />

<h4 id="8-loading-states">8. <strong>Loading States</strong></h4>
<p><strong>Váº¥n Ä‘á»:</strong></p>
<ul>
  <li>Loading states khÃ´ng nháº¥t quÃ¡n</li>
  <li>Má»™t sá»‘ pages khÃ´ng cÃ³ loading indicator</li>
  <li>KhÃ´ng cÃ³ skeleton screens</li>
</ul>

<p><strong>NÃªn:</strong></p>
<ul>
  <li>Táº¡o loading component</li>
  <li>Skeleton screens cho better UX</li>
</ul>

<hr />

<h4 id="9-pagination-khÃ´ng-Ä‘Æ°á»£c-sá»­-dá»¥ng">9. <strong>Pagination KhÃ´ng ÄÆ°á»£c Sá»­ Dá»¥ng</strong></h4>
<p><strong>Váº¥n Ä‘á»:</strong></p>
<ul>
  <li>API cÃ³ pagination nhÆ°ng frontend khÃ´ng dÃ¹ng</li>
  <li>Load táº¥t cáº£ articles má»™t lÃºc</li>
  <li>Performance issues vá»›i nhiá»u articles</li>
</ul>

<p><strong>NÃªn:</strong></p>
<ul>
  <li>Implement pagination UI</li>
  <li>Load more / infinite scroll</li>
</ul>

<hr />

<h4 id="10-khÃ´ng-cÃ³-routing-system">10. <strong>KhÃ´ng CÃ³ Routing System</strong></h4>
<p><strong>Váº¥n Ä‘á»:</strong></p>
<ul>
  <li>DÃ¹ng query parameters (<code class="language-plaintext highlighter-rouge">?slug=xxx</code>)</li>
  <li>KhÃ´ng cÃ³ proper routing</li>
  <li>URL khÃ´ng clean</li>
</ul>

<p><strong>NÃªn:</strong></p>
<ul>
  <li>Implement client-side routing</li>
  <li>Hoáº·c dÃ¹ng Jekyll routing vá»›i proper permalinks</li>
</ul>

<hr />

<h3 id="-nice-to-have">ğŸŸ¢ Nice to Have</h3>

<h4 id="11-state-management">11. <strong>State Management</strong></h4>
<ul>
  <li>KhÃ´ng cÃ³ state management</li>
  <li>Data Ä‘Æ°á»£c fetch láº¡i má»—i láº§n</li>
  <li>KhÃ´ng cÃ³ caching</li>
</ul>

<p><strong>NÃªn:</strong></p>
<ul>
  <li>Implement simple state management</li>
  <li>Cache API responses</li>
  <li>Use localStorage for offline support</li>
</ul>

<hr />

<h4 id="12-component-structure">12. <strong>Component Structure</strong></h4>
<ul>
  <li>KhÃ´ng cÃ³ component system</li>
  <li>Code duplication</li>
  <li>KhÃ³ reuse</li>
</ul>

<p><strong>NÃªn:</strong></p>
<ul>
  <li>Táº¡o reusable components</li>
  <li>Hoáº·c migrate sang framework (React/Vue)</li>
</ul>

<hr />

<h4 id="13-typescript--type-safety">13. <strong>TypeScript / Type Safety</strong></h4>
<ul>
  <li>KhÃ´ng cÃ³ type checking</li>
  <li>Dá»… cÃ³ bugs runtime</li>
</ul>

<p><strong>NÃªn:</strong></p>
<ul>
  <li>ThÃªm JSDoc comments</li>
  <li>Hoáº·c migrate sang TypeScript</li>
</ul>

<hr />

<h2 id="-checklist-cáº£i-thiá»‡n">ğŸ“‹ Checklist Cáº£i Thiá»‡n</h2>

<h3 id="priority-1-critical">Priority 1 (Critical)</h3>
<ul class="task-list">
  <li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" disabled="disabled" />Fix API response format mismatch</li>
  <li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" disabled="disabled" />Fix XSS vulnerability trong comments</li>
  <li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" disabled="disabled" />Fix view count key mismatch (pair_id vs slug)</li>
  <li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" disabled="disabled" />Fix hardcoded author_id</li>
</ul>

<h3 id="priority-2-important">Priority 2 (Important)</h3>
<ul class="task-list">
  <li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" disabled="disabled" />TÃ¡ch inline scripts ra files riÃªng</li>
  <li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" disabled="disabled" />Standardize API URL configuration</li>
  <li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" disabled="disabled" />Improve error handling</li>
  <li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" disabled="disabled" />Add consistent loading states</li>
  <li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" disabled="disabled" />Implement pagination</li>
</ul>

<h3 id="priority-3-nice-to-have">Priority 3 (Nice to Have)</h3>
<ul class="task-list">
  <li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" disabled="disabled" />Add routing system</li>
  <li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" disabled="disabled" />Implement state management</li>
  <li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" disabled="disabled" />Create component structure</li>
  <li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" disabled="disabled" />Add TypeScript/JSDoc</li>
</ul>

<hr />

<h2 id="-recommendations">ğŸ¯ Recommendations</h2>

<h3 id="short-term-1-2-weeks">Short Term (1-2 weeks)</h3>
<ol>
  <li><strong>Fix Critical Issues:</strong>
    <ul>
      <li>API response format</li>
      <li>XSS vulnerability</li>
      <li>View count key mismatch</li>
      <li>Author ID</li>
    </ul>
  </li>
  <li><strong>Refactor Code:</strong>
    <ul>
      <li>TÃ¡ch inline scripts</li>
      <li>Standardize config</li>
      <li>Improve error handling</li>
    </ul>
  </li>
</ol>

<h3 id="medium-term-1-2-months">Medium Term (1-2 months)</h3>
<ol>
  <li><strong>Improve Architecture:</strong>
    <ul>
      <li>Add routing</li>
      <li>Implement pagination</li>
      <li>Better state management</li>
    </ul>
  </li>
  <li><strong>Enhance UX:</strong>
    <ul>
      <li>Loading states</li>
      <li>Error messages</li>
      <li>Skeleton screens</li>
    </ul>
  </li>
</ol>

<h3 id="long-term-3-months">Long Term (3+ months)</h3>
<ol>
  <li><strong>Consider Migration:</strong>
    <ul>
      <li>Evaluate React/Vue migration</li>
      <li>Or improve Jekyll + Vanilla JS</li>
      <li>Add build tools (Webpack/Vite)</li>
    </ul>
  </li>
  <li><strong>Add Features:</strong>
    <ul>
      <li>Offline support</li>
      <li>PWA capabilities</li>
      <li>Better admin UX</li>
    </ul>
  </li>
</ol>

<hr />

<h2 id="-quick-fixes">ğŸ”§ Quick Fixes</h2>

<h3 id="fix-1-api-response-format">Fix 1: API Response Format</h3>
<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// assets/js/api-helper.js</span>
<span class="k">async</span> <span class="kd">function</span> <span class="nx">fetchArticles</span><span class="p">(</span><span class="nx">lang</span><span class="p">,</span> <span class="nx">limit</span> <span class="o">=</span> <span class="mi">20</span><span class="p">,</span> <span class="nx">offset</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="nx">res</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">fetch</span><span class="p">(</span><span class="s2">`</span><span class="p">${</span><span class="nx">API_URL</span><span class="p">}</span><span class="s2">/api/articles?lang=</span><span class="p">${</span><span class="nx">lang</span><span class="p">}</span><span class="s2">&amp;limit=</span><span class="p">${</span><span class="nx">limit</span><span class="p">}</span><span class="s2">&amp;offset=</span><span class="p">${</span><span class="nx">offset</span><span class="p">}</span><span class="s2">`</span><span class="p">);</span>
  <span class="kd">const</span> <span class="nx">data</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">res</span><span class="p">.</span><span class="nx">json</span><span class="p">();</span>
  
  <span class="c1">// Handle both old and new format</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">data</span><span class="p">.</span><span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="p">{</span> <span class="na">articles</span><span class="p">:</span> <span class="nx">data</span><span class="p">.</span><span class="nx">data</span><span class="p">,</span> <span class="na">pagination</span><span class="p">:</span> <span class="nx">data</span><span class="p">.</span><span class="nx">pagination</span> <span class="p">};</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="p">{</span> <span class="na">articles</span><span class="p">:</span> <span class="nx">data</span><span class="p">,</span> <span class="na">pagination</span><span class="p">:</span> <span class="kc">null</span> <span class="p">};</span>
<span class="p">}</span>
</code></pre></div></div>

<h3 id="fix-2-xss-protection">Fix 2: XSS Protection</h3>
<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// assets/js/utils.js</span>
<span class="kd">function</span> <span class="nx">escapeHtml</span><span class="p">(</span><span class="nx">text</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="nx">div</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="dl">'</span><span class="s1">div</span><span class="dl">'</span><span class="p">);</span>
  <span class="nx">div</span><span class="p">.</span><span class="nx">textContent</span> <span class="o">=</span> <span class="nx">text</span><span class="p">;</span>
  <span class="k">return</span> <span class="nx">div</span><span class="p">.</span><span class="nx">innerHTML</span><span class="p">;</span>
<span class="p">}</span>

<span class="kd">function</span> <span class="nx">renderComment</span><span class="p">(</span><span class="nx">comment</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">return</span> <span class="s2">`
    &lt;div class="comment"&gt;
      &lt;strong&gt;</span><span class="p">${</span><span class="nx">escapeHtml</span><span class="p">(</span><span class="nx">comment</span><span class="p">.</span><span class="nx">guest_name</span><span class="p">)}</span><span class="s2">&lt;/strong&gt;
      &lt;p&gt;</span><span class="p">${</span><span class="nx">escapeHtml</span><span class="p">(</span><span class="nx">comment</span><span class="p">.</span><span class="nx">content</span><span class="p">)}</span><span class="s2">&lt;/p&gt;
    &lt;/div&gt;
  `</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<h3 id="fix-3-view-count-fix">Fix 3: View Count Fix</h3>
<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// Option: Use slug instead of pair_id</span>
<span class="c1">// In post.html, add slug to meta tag</span>
<span class="o">&lt;</span><span class="nx">meta</span> <span class="nx">name</span><span class="o">=</span><span class="dl">"</span><span class="s2">article-slug</span><span class="dl">"</span> <span class="nx">content</span><span class="o">=</span><span class="dl">""</span><span class="o">&gt;</span>

<span class="c1">// In view-count.js</span>
<span class="kd">const</span> <span class="nx">slug</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="dl">'</span><span class="s1">meta[name="article-slug"]</span><span class="dl">'</span><span class="p">)?.</span><span class="nx">getAttribute</span><span class="p">(</span><span class="dl">'</span><span class="s1">content</span><span class="dl">'</span><span class="p">);</span>
<span class="k">if</span> <span class="p">(</span><span class="nx">slug</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">fetch</span><span class="p">(</span><span class="s2">`</span><span class="p">${</span><span class="nx">apiUrl</span><span class="p">}</span><span class="s2">/increment?key=</span><span class="p">${</span><span class="nx">slug</span><span class="p">}</span><span class="s2">`</span><span class="p">,</span> <span class="p">{</span> <span class="na">method</span><span class="p">:</span> <span class="dl">'</span><span class="s1">POST</span><span class="dl">'</span> <span class="p">});</span>
<span class="p">}</span>
</code></pre></div></div>

<h3 id="fix-4-author-id">Fix 4: Author ID</h3>
<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// In admin.js</span>
<span class="kd">function</span> <span class="nx">getCurrentUser</span><span class="p">()</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="nx">userStr</span> <span class="o">=</span> <span class="nx">localStorage</span><span class="p">.</span><span class="nx">getItem</span><span class="p">(</span><span class="dl">"</span><span class="s2">user</span><span class="dl">"</span><span class="p">);</span>
  <span class="k">return</span> <span class="nx">userStr</span> <span class="p">?</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="nx">userStr</span><span class="p">)</span> <span class="p">:</span> <span class="kc">null</span><span class="p">;</span>
<span class="p">}</span>

<span class="kd">const</span> <span class="nx">user</span> <span class="o">=</span> <span class="nx">getCurrentUser</span><span class="p">();</span>
<span class="kd">const</span> <span class="nx">payload</span> <span class="o">=</span> <span class="p">{</span>
  <span class="na">author_id</span><span class="p">:</span> <span class="nx">user</span><span class="p">?.</span><span class="nx">id</span> <span class="o">||</span> <span class="kc">null</span><span class="p">,</span>
  <span class="c1">// ...</span>
<span class="p">};</span>
</code></pre></div></div>

<hr />

<h2 id="-architecture-score">ğŸ“Š Architecture Score</h2>

<p><strong>Äiá»ƒm sá»‘:</strong> 6/10</p>

<p><strong>Breakdown:</strong></p>
<ul>
  <li>Structure: 7/10 âœ…</li>
  <li>Security: 4/10 âš ï¸</li>
  <li>Maintainability: 5/10 âš ï¸</li>
  <li>Performance: 6/10 âš ï¸</li>
  <li>UX: 6/10 âš ï¸</li>
</ul>

<p><strong>ÄÃ¡nh giÃ¡:</strong></p>
<ul>
  <li>âœ… Cáº¥u trÃºc cÆ¡ báº£n tá»‘t</li>
  <li>âœ… Jekyll integration tá»‘t</li>
  <li>âš ï¸ Cáº§n fix security issues</li>
  <li>âš ï¸ Cáº§n improve code organization</li>
  <li>âš ï¸ Cáº§n better error handling</li>
</ul>

<hr />

<h2 id="-references">ğŸ“š References</h2>

<ul>
  <li><a href="https://jekyllrb.com/docs/best-practices/">Jekyll Best Practices</a></li>
  <li><a href="https://cheatsheetseries.owasp.org/cheatsheets/Cross_Site_Scripting_Prevention_Cheat_Sheet.html">OWASP XSS Prevention</a></li>
  <li><a href="https://www.patterns.dev/">Frontend Architecture Patterns</a></li>
</ul>


    </main>
    <footer class="site">
  <div class="wrap">
    <div class="panel">
      <div>
        <span class="pill">EN/VI</span>
        <span class="pill">GitHub Pages</span>
        <span class="pill">Jekyll</span>
      </div>
      <div style="margin-top: 10px;">
        Â© 2026 SE-knowledges. Built with Jekyll on GitHub Pages.
      </div>
    </div>
  </div>
</footer>


  </body>
</html>

