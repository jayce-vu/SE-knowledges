<!doctype html>
<html lang="{{ page.lang | default: 'en' }}">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>
      {% if page.title %}{{ page.title }} Â· {% endif %}{{ site.title }}
    </title>
    
    <!-- Default Meta Tags -->
    <meta name="description" content="{{ site.description | default: 'Technical notes and articles in Vietnamese and English.' }}" />
    
    <!-- Open Graph / Facebook / LinkedIn / WhatsApp / Telegram / Discord / Slack -->
    <meta property="og:type" content="website" />
    <meta property="og:url" content="{{ site.url }}{{ site.baseurl }}{{ page.url }}" />
    <meta property="og:title" content="{% if page.title %}{{ page.title }}{% else %}{{ site.title }}{% endif %}" />
    <meta property="og:description" content="{{ site.description | default: 'Technical notes and articles in Vietnamese and English.' }}" />
    <meta property="og:site_name" content="{{ site.title }}" />
    <meta property="og:locale" content="{% if page.lang == 'vi' %}vi_VN{% else %}en_US{% endif %}" />
    
    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:url" content="{{ site.url }}{{ site.baseurl }}{{ page.url }}" />
    <meta name="twitter:title" content="{% if page.title %}{{ page.title }}{% else %}{{ site.title }}{% endif %}" />
    <meta name="twitter:description" content="{{ site.description | default: 'Technical notes and articles in Vietnamese and English.' }}" />
    
    <!-- Additional Meta Tags for Better Compatibility -->
    <meta name="theme-color" content="#0b1020" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
    
    <link rel="icon" type="image/svg+xml" href="{{ '/assets/favicon.svg' | relative_url }}">
    <link rel="stylesheet" href="{{ '/assets/css/style.css' | relative_url }}" />
    {% if page.path == 'view.html' or page.url contains '/view' %}
      <!-- Highlight.js CSS for article viewer -->
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@11.9.0/styles/github-dark.min.css">
    {% endif %}
  </head>
  <body>
    {% include header.html %}
    <main class="wrap">
      {{ content }}
    </main>
    {% include footer.html %}
    
    <!-- Global API Configuration -->
    <script>
      window.API_URL = "{{ site.view_api_url }}";
      window.VIEW_API_URL = "{{ site.view_api_url }}";
      console.log("API URL configured:", window.API_URL);
    </script>
    
    <!-- Load utils.js for all pages -->
    <script src="{{ '/assets/js/utils.js' | relative_url }}"></script>
    
    <!-- Page-specific scripts -->
    {% if page.path == 'index.html' or page.url == '/' or page.layout == 'home' %}
      <!-- Home page scripts -->
      <script src="{{ '/assets/js/home.js' | relative_url }}"></script>
      <script>
        console.log("Home page scripts loaded for:", page.path || page.url);
      </script>
    {% endif %}
    
    {% if page.path == 'view.html' or page.url contains '/view' %}
      <!-- Article viewer scripts -->
      <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
      <script src="https://cdn.jsdelivr.net/npm/highlight.js@11.9.0/lib/highlight.min.js"></script>
      <script src="{{ '/assets/js/article-viewer.js' | relative_url }}"></script>
      <script>
        console.log("Article viewer scripts loaded");
      </script>
    {% endif %}
    
    {% if page.path == 'login.html' or page.url contains '/login' %}
      <!-- Login page scripts -->
      <script src="{{ '/assets/js/auth.js' | relative_url }}"></script>
      <script>
        console.log("Auth scripts loaded");
      </script>
    {% endif %}
    
    {% if page.path == 'admin.html' or page.url contains '/admin' %}
      <!-- Admin page scripts -->
      <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
      <script src="{{ '/assets/js/admin.js' | relative_url }}"></script>
      <script>
        console.log("Admin scripts loaded");
      </script>
    {% endif %}
    
    <!-- Verify utils loaded -->
    <script>
      console.log("Utils loaded:", typeof parseApiResponse !== 'undefined');
    </script>
  </body>
</html>

